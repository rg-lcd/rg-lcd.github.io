<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description"
    content="We proposed closed-form policy improvement operators and modeled the behavior policies as a Gaussian Mixture.">
  <meta name="keywords" content=" Offline Reinforcement Learning algorithms,Deep Reinforcement Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Offline Reinforcement Learning with Closed-Form Policy Improvement Operators
  </title>
  <!-- custom fonts -->
  <link rel="stylesheet" type="text/css"
    href="https://cdn.rawgit.com/dreampulse/computer-modern-web-font/master/fonts.css">
  <link href="https://fonts.cdnfonts.com/css/proxima-nova-2" rel="stylesheet">
  <!-- end custom fonts -->

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" type="ico" href="./static/favicon.ico">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>

<body>

  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            More Research
          </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://sites.google.com/eng.ucsd.edu/multi-task-batch-reinforcement/home">
              Metric Learning Offline RL
            </a>
            <a class="navbar-item" href="https://arxiv.org/abs/2110.12081.pdf">
              Off-policy RL with Optimism and DICE
            </a>
            <a class="navbar-item" href="https://lcd.eddie.win">
              Language Control Diffusion
            </a>
          </div>
        </div>
      </div>

    </div>
  </nav>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Offline Reinforcement Learning with Closed-Form Policy Improvement
              Operators
            </h1>

            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://sites.google.com/view/jiachenli/home">Jiachen Li</a><sup>*</sup><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://eddie.win">Edwin Zhang</a><sup>*</sup><sup>1,3</sup>,</span>
              <span class="author-block">
                <a href="https://mingyin0312.github.io/">Ming Yin</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a href="https://www.cs.bu.edu/groups/ivc/qinxun/">Qinxun Bai</a><sup>2</sup>,
              </span>
              <span class="author-block">
                <a href="https://sites.cs.ucsb.edu/~yuxiangw/">Yu-Xiang Wang</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a href="https://sites.cs.ucsb.edu/~william/">William Yang Wang</a><sup>1</sup>
              </span>
            </div>


            <div class="is-size-5 publication-authors" style="margin-top: 15px;">
              <span class="author-block"><sup>1</sup>UC Santa Barbara,</span>
              <span class="author-block"><sup>2</sup>Horizon Robotics,</span>
              <span class="author-block"><sup>3</sup>Harvard University</span>
            </div>
            <div class="publication-authors">
              <span class="author-block"><sup>*</sup>Equal Contribution</span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a target="_blank" href="https://proceedings.mlr.press/v202/li23av/li23av.pdf" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <span class="link-block">
                  <a target="_blank" href="https://arxiv.org/abs/2211.15956"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- Code Link. -->
                <span class="link-block">
                  <a target="_blank" href="https://github.com/cfpi-icml23/cfpi"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
                <!-- Dataset Link. -->
                <!-- <span class="link-block">
                  <a target="_blank" href="https://github.com/google/nerfies/releases/tag/0.1"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="far fa-images"></i>
                    </span>
                    <span>Data</span>
                  </a>
                </span> -->
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <img src="./static/images/1.png" alt="" srcset="">

        <h2 class="subtitle has-text-centered">
          <span class="dnerf">Closed-form policy improvement operators</span> enable stable offline policy improvement.
        </h2>
      </div>
    </div>
  </section>


  <section class="hero is-light is-small">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item">
            <img src="./static/images/figures/iterative_pac/antmaze-large-diverse-v0.png" style="width: auto;" alt="">j
          </div>
          <div class="item">
            <img src="./static/images/figures/iterative_pac/antmaze-large-play-v0.png" style="width: auto;" alt="">j
          </div>
          <div class="item">
            <img src="./static/images/figures/iterative_pac/antmaze-medium-diverse-v0.png" style="width: auto;" alt="">
          </div>
          <div class="item">
            <img src="./static/images/figures/iterative_pac/antmaze-medium-play-v0.png" style="width: auto;" alt="">
          </div>
          <div class="item">
            <img src="./static/images/figures/iterative_pac/antmaze-umaze-diverse-v0.png" style="width: auto;" alt="">
          </div>
          <div class="item">
            <img src="./static/images/figures/iterative_pac/antmaze-umaze-v0.png" style="width: auto;" alt="">
          </div>

        </div>
      </div>
      <div class="container is-max-desktop">
        <img style="border: 1px solid black; padding: 10px; background: white; margin-top: 40px; border-radius: 10px;"
          src="./static/images/2.png" width="100%" alt="">
      </div>
      <div class="has-text-centered" style="margin: 10px 0">
        Our method's offline training results on AntMaze. Shaded area denotes one standard deviation.
      </div>
    </div>

  </section>


  <section class="section">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Behavior constrained policy optimization has been demonstrated to be a successful paradigm for tackling
              Offline
              Reinforcement Learning. By exploiting historical transitions, a policy is trained to maximize a learned
              value function
              while constrained by the behavior policy to avoid a significant distributional shift. </p>
            <p>
              In this project, we
              propose <span class="dnerf"> closed-form policy improvement operators</span>. We make the novel
              observation
              that the behavior constraint
              naturally motivates
              the use of first-order Taylor approximation, leading to a linear approximation of the policy objective.
            </p>
            <p>
              Additionally, as
              practical datasets are usually collected by heterogeneous policies, we model the behavior policies as a
              Gaussian Mixture
              and overcome the induced optimization difficulties by leveraging the LogSumExp's lower bound and Jensen's
              Inequality,
              giving rise to a closed-form policy improvement operator.</p>
            <p>
              We instantiate both one-step and iterative
              offline RL
              algorithms with our novel policy improvement operators and empirically demonstrate {their} effectiveness
              over
              state-of-the-art algorithms on the standard D4RL benchmark.
            </p>
          </div>
        </div>
      </div>
      <!--/ Abstract. -->

      <!-- Paper video. -->
      <div class="columns is-centered has-text-centered">
        <div class="column" style="height: 100%">
          <h2 class="title is-3">Video</h2>
          <div class="publication-video h750">

            <iframe
              src="https://slideslive.com/embed/presentation/38993793?auto_load=true&amp;auto_play=false&amp;zoom_ratio=&amp;disable_fullscreen=false&amp;locale=en&amp;vertical_enabled=true&amp;vertical_enabled_on_mobile=false&amp;allow_hidden_controls_when_paused=true&amp;fit_to_viewport=true&amp;custom_user_id=&amp;user_uuid=df1abce8-48c1-4383-828e-a2574e02127f"
              scrolling="no" frameborder="0"
              sandbox="allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-top-navigation"
              allow="autoplay; fullscreen" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen=""
              class="h750" style="margin: 0px auto; display: block; width: 100%;"></iframe>
            <!-- <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0" frameborder="0"
              allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
          </div>
        </div>
      </div>
      <!--/ Paper video. -->
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">

      <!-- Concurrent Work. -->
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">Statistical Evaluation</h2>

          <img src="./static/images/figures/score_dist.png" alt="" srcset="">
          <img src="./static/images/figures/reliable_eval.png" alt="" srcset="">
          <div class="content has-text-justified">
            <p>Here, I-MG (MG-PAC) and I-SG (SG-PAC) refer to our method.</p>
            <p>
              <a href="https://arxiv.org/abs/2108.13264" target="_blank">Performance profiles</a> (score distributions)
              for all methods on the 9 tasks from the D4RL MuJoCo Gym
              domain.
              The average score is calculated by averaging all runs within one task. Each task contains 10 seeds, and
              each seed
              evaluates
              for 100 episodes. Shaded area denotes 95% confidence bands based on percentile bootstrap and stratified
              sampling. The η value where the curves intersect with the dashed horizontal line y = 0.5 corresponds
              to the median,
              while the area under the performance curves corresponds to the mean.
            </p>
            <p>
              To demonstrate the superiority of our methods over the baselines and provide reliable evaluation results,
              we follow the
              evaluation protocols proposed in <a href="https://arxiv.org/abs/2108.13264" target="_blank">(Agarwal et
                al., 2021)</a>.
              Specifically, we adopt the
              evaluation methods for all methods with N tasks × N seeds runs in total.
              Evaluation results demonstrate that our method outperforms the baseline methods by asignificant margin
              based
              on all four reliable metrics.
            </p>
          </div>
        </div>
      </div>
      <!--/ Concurrent Work. -->

      <div class="container is-max-desktop">

        <!-- Concurrent Work. -->
        <div class="columns is-centered">
          <div class="column is-full-width">
            <h2 class="title is-3">Related Work</h2>

            <div class="content has-text-justified">
              <p>
                This project would not be possible without the following wonderful prior work.
              </p>

              <p>
                <a href="https://github.com/microsoft/oac-explore">Optimistic Actor Critic</a> gave inspiration to our
                method,
                <a href="https://github.com/Farama-Foundation/D4RL">D4RL</a>
                provides the dataset and benchmark for evaluating the performance of our agent, and
                <a href="https://github.com/rail-berkeley/rlkit/">RLkit</a> offered a strong RL framework
                for building our code from.
              </p>
            </div>
          </div>
        </div>
        <!--/ Concurrent Work. -->
  </section>


  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@misc{li2022offline,
    title={Offline Reinforcement Learning with Closed-Form Policy Improvement Operators},
    author={Jiachen Li and Edwin Zhang and Ming Yin and Qinxun Bai and Yu-Xiang Wang and William Yang Wang},
    journal={ICML},
    year={2023},
}</code></pre>
    </div>
  </section>


  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
        <a class="icon-link" href="https://proceedings.mlr.press/v202/li23av/li23av.pdf">
          <i class="fas fa-file-pdf"></i>
        </a>
        <a class="icon-link" href="https://github.com/cfpo-icml23/cfpi" class="external-link" disabled>
          <i class="fab fa-github"></i>
        </a>
      </div>
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p style="text-align: center
              ">
              Website templated borrowed from <a href="https://github.com/nerfies/nerfies.github.io">nerfies.</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>


</body>

</html>